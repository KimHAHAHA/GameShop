<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>KIMKY STORE - Store</title>
  </head>
  <body>
    <app-header></app-header>

    <main class="container">
      <div class="game-card">
        <img
          [src]="
            game.image_url ||
            'https://upload.wikimedia.org/wikipedia/commons/6/65/No-Image-Placeholder.svg'
          "
          [alt]="game.title"
        />

        <div class="game-info">
          <h2>{{ game.title }}</h2>
          <p><strong>ประเภท:</strong> {{ game.category }}</p>
          <p><strong>ราคา:</strong> {{ game.price | currency : "THB" }}</p>
          <p>
            <strong>วันวางขาย:</strong>
            {{ game.created_at | date : "dd/MM/yyyy" }}
          </p>
          <p><strong>รายละเอียด:</strong> {{ game.description }}</p>

          <div class="btn-group">
            <button class="btn-buy" (click)="onBuy()">BUY</button>
            <button class="btn-add" (click)="onAddToCart()">+</button>
          </div>
        </div>
      </div>
    </main>

    <!-- Popup -->
    <div
      class="popup-overlay"
      *ngIf="showPopup"
      style="
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.7);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
      "
    >
      <div
        class="popup-box"
        style="
          background: #111;
          color: #fff;
          padding: 20px;
          border-radius: 8px;
          border: 1px solid #00ffff;
          min-width: 320px;
          box-shadow: 0 0 12px rgba(0, 255, 195, 0.4);
        "
      >
        <h3 style="margin-top: 0">ยืนยันการซื้อ</h3>

        <p class="price" style="margin-bottom: 8px">
          ราคา: <span>{{ game.price | currency : "THB" }}</span>
        </p>

        <!-- ช่องกรอกโค้ดส่วนลด -->
        <div style="margin-top: 10px">
          <label
            for="discount"
            style="display: block; margin-bottom: 6px; font-weight: 500"
          >
            โค้ดส่วนลด:
          </label>
          <input
            id="discount"
            type="text"
            placeholder="กรอกโค้ดส่วนลดที่นี่"
            [(ngModel)]="discountCode"
            name="discountCode"
            style="
              width: 100%;
              padding: 8px 10px;
              border-radius: 6px;
              border: 1px solid #00ffff;
              background: #000;
              color: #fff;
              outline: none;
            "
          />
        </div>

        <div
          class="popup-btns"
          style="
            margin-top: 20px;
            text-align: right;
            display: flex;
            justify-content: flex-end;
          "
        >
          <button
            (click)="closePopup()"
            style="
              background: #444;
              color: #fff;
              border: none;
              padding: 8px 14px;
              border-radius: 5px;
              cursor: pointer;
              margin-right: 10px;
            "
          >
            Cancel
          </button>

          <button
            (click)="confirmPurchase()"
            style="
              background: #00ffc3;
              color: #000;
              border: none;
              padding: 8px 14px;
              border-radius: 5px;
              cursor: pointer;
              font-weight: 600;
            "
          >
            Confirm
          </button>
        </div>
      </div>
    </div>
  </body>
</html>
